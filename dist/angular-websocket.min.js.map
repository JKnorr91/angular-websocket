{"version":3,"sources":["dist/angular-websocket.js"],"names":["global","factory","define","amd","exports","module","mod","angularWebsocket","this","$WebSocketProvider","$rootScope","$q","$timeout","$websocketBackend","$WebSocket","url","protocols","options","isObject","isArray","undefined","ssl","test","scope","rootScopeFailover","useApplyAsync","initialTimeout","maxTimeout","reconnectIfNotNormalClose","binaryType","_reconnectAttempts","sendQueue","onOpenCallbacks","onMessageCallbacks","onErrorCallbacks","onCloseCallbacks","objectFreeze","_readyStateConstants","_connect","_setInternalState","prototype","CONNECTING","OPEN","CLOSING","CLOSED","RECONNECT_ABORTED","_normalCloseCode","_reconnectableStatusCodes","safeDigest","autoApply","$$phase","$digest","bindToScope","self","$on","force","socket","readyState","create","onmessage","angular","bind","_onMessageHandler","onopen","_onOpenHandler","onerror","_onErrorHandler","onclose","_onCloseHandler","fireQueue","length","data","shift","send","isString","message","JSON","stringify","deferred","resolve","notifyOpenCallbacks","event","i","call","notifyCloseCallbacks","notifyErrorCallbacks","onOpen","cb","push","onClose","onError","onMessage","callback","isFunction","Error","isDefined","filter","RegExp","fn","pattern","$applyAsync","code","indexOf","reconnect","applyAsyncOrDigest","args","arraySlice","arguments","apply","currentCallback","exec","close","bufferedAmount","cancelableify","promise","cancel","then","newPromise","reason","splice","reject","defer","isMocked","isConnected","mockSend","backoffDelay","_getBackoffDelay","backoffDelaySeconds","console","log","attempt","R","Math","random","T","F","N","M","floor","min","pow","state","objectDefineProperty","_internalConnectionState","forEach","pending","get","set","$WebSocketBackendProvider","$log","match","Socket","createWebSocketBackend","warn","Object","defineProperty","value","window","WebSocket","MozWebSocket","noop","freeze","Array","slice","elt","len","from","Number","ceil","service","default"],"mappings":"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"}